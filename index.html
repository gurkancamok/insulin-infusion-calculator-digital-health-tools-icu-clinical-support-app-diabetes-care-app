<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>İnsülin İnfüzyon Protokolü Uygulaması</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 950px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        h1, h2, h3 {
            color: #0056b3;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .section {
            margin-bottom: 30px;
            padding: 15px;
            background-color: #f9f9f9;
            border-left: 5px solid #007bff;
            border-radius: 5px;
        }
        .input-group {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 15px;
        }
        .input-group label {
            flex: 1 1 180px;
            font-weight: bold;
            color: #555;
            text-align: right;
            padding-right: 10px;
        }
        .input-group input, .input-group select {
            flex: 2 1 250px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }
        .input-group button {
            flex: 1 1 200px;
            padding: 12px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 17px;
            font-weight: bold;
            transition: background-color 0.3s ease;
            margin-left: auto;
            margin-right: auto;
            display: block;
            width: fit-content;
        }
        .input-group button:hover {
            background-color: #218838;
        }
        .result-box {
            margin-top: 30px;
            padding: 20px;
            background-color: #e9f7ef;
            border: 2px solid #28a745;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            color: #1a5a2a;
        }
        .warning-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3cd;
            border: 2px solid #ffeeba;
            border-radius: 8px;
            font-size: 0.95em;
        }
        .error-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8d7da;
            border: 2px solid #f5c6cb;
            border-radius: 8px;
            color: #721c24;
            font-size: 0.95em;
        }
        ul {
            list-style-type: disc;
            padding-left: 25px;
        }
        ul li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        ul li strong {
            color: #0056b3;
        }
        ol {
            list-style-type: lower-alpha;
            padding-left: 25px;
        }
        ol li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-family: Arial, sans-serif;
            border-spacing: 0;
            font-size: 0.85em;
        }
        table, th, td {
            border: 1px solid #999;
        }
        th, td {
            padding: 5px;
            text-align: center;
            vertical-align: middle;
            word-wrap: break-word;
            color: #333;
            line-height: 1.1;
            font-weight: bold;
        }
        th {
            background-color: #007bff;
            color: white;
            font-weight: bold;
            padding: 7px 5px;
        }
        td:first-child {
            width: 25%;
            text-align: left;
            padding-left: 8px;
            font-weight: bold;
            color: #333;
        }
        .explanation-cell {
            background-color: #D8BFD8;
        }
        .bold-text {
            font-weight: bold;
        }
        .special-note-cell {
            background-color: #e6f7ff;
            border: 1px solid #91d5ff;
            text-align: left;
            padding: 8px;
            vertical-align: top;
            line-height: 1.3;
        }
        .infusion-rate-table {
            margin-top: 30px;
        }
        .infusion-rate-table th {
            background-color: #6c757d;
        }
        .important-note-box {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #fff8e1;
            border: 2px solid #ffecb3;
            border-radius: 8px;
            color: #663c00;
            font-size: 0.95em;
            font-weight: bold;
        }
        /* Accordion Stilleri */
        .accordion {
            background-color: #eee;
            color: #444;
            cursor: pointer;
            padding: 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 15px;
            transition: 0.4s;
            border-radius: 5px;
            margin-bottom: 5px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .accordion.active, .accordion:hover {
            background-color: #ccc;
        }
        .warning-accordion {
            color: red;
        }
        .panel {
            padding: 0 18px;
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .panel p, .panel ul, .panel ol {
            padding-top: 10px;
            padding-bottom: 10px;
        }
        .accordion-arrow {
            font-size: 1.2em;
            font-weight: bold;
            transform: rotate(0deg);
            transition: transform 0.2s ease-out;
        }
        .accordion.active .accordion-arrow {
            transform: rotate(-180deg);
        }
        .bibliography {
            margin-top: 40px;
            border-top: 2px solid #e0e0e0;
            padding-top: 20px;
        }
        .bibliography h2 {
            margin-top: 0;
        }
        .bibliography ol {
            list-style-type: decimal;
            padding-left: 25px;
        }
        .bibliography li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        .footer-text {
            text-align: right;
            margin-top: 20px;
            font-size: 0.6em;
            color: #666; /* Bu satır güncellendi */
            line-height: 1.0;
        }
        .footer-text p {
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>İnsülin İnfüzyon Protokolü Uygulaması</h1>

        <div class="section">
            <h2>İnfüzyon Ayarlaması Hesaplayıcı</h2>

            <div class="important-note-box">
                <strong>Önemli Not:</strong> İnsülin İnfüzyon Protokolü Uygulamasında yanlışlık olduğunu düşündüğünüz durumlarda Hayati risk nedeniyle, herhangi bir tereddütte orijinal protokole başvurulması önemlidir.
            </div>

            <div class="input-group">
                <label for="currentBs">Mevcut Kan Şekeri (mg/dl):</label>
                <input type="number" id="currentBs" min="1" required>
            </div>
            <div class="input-group">
                <label for="previousBs">Önceki Kan Şekeri (mg/dl):</label>
                <input type="number" id="previousBs" min="1">
                <small style="flex-basis: 100%; text-align: right; padding-right: 15px; color: #666;">Önceki değer yoksa veya ilk ölçüm ise boş bırakın.</small>
            </div>
            <div class="input-group">
                <label for="previousBsTime">Önceki KŞ Ölçüm Süresi (saat):</label>
                <input type="number" id="previousBsTime" min="0.1" step="0.1" value="2">
                <small style="flex-basis: 100%; text-align: right; padding-right: 15px; color: #666;">Önceki ölçümden bu yana geçen süre (saat). Eğer önceki kan şekeri değeri girilmişse gereklidir.</small>
            </div>
            <div class="input-group">
                <label for="currentInfusionRate">Mevcut İnfüzyon Hızı (Ünite/Saat):</label>
                <input type="number" id="currentInfusionRate" min="0" step="0.1" required>
            </div>
            <div class="input-group">
                <button onclick="calculateInfusion()">İnfüzyon Ayarlamasını Hesapla</button>
            </div>

            <div class="result-box" id="result">
                Burada hesaplama sonucu görünecektir.
            </div>
            <div class="error-box" id="error" style="display:none;">
                Hata: Lütfen tüm gerekli alanları doldurun ve geçerli değerler girin.
            </div>

            <button class="accordion">1. Kan Şekeri 50 mg/dl'nin Altındaysa <span class="accordion-arrow">&#9660;</span></button>
            <div class="panel">
                <ul>
                    <li>İnsülin İnfüzyonunu **STOP'la**. 25 gram (%50 Dekstrozdan 50 ml (15 dakikada bolus) veya %30 Dekstrozdan 85 ml (9 dakikada bolus)) IV dekstroz bolus ver. Kan Şekeri 15 dakikada bir kontrol et.</li>
                    <li>Kan Şekeri 100 mg/dl ve üzerine ulaşırsa 1 saat bekle, sonra insülin infüzyonuna orijinal hızdan **%50 düşüğüyle** başla.</li>
                </ul>
            </div>

            <button class="accordion">2. Kan Şekeri 50-74 mg/dl Arasındaysa <span class="accordion-arrow">&#9660;</span></button>
            <div class="panel">
                <p><strong>Hastada hipoglisemi semptomları VARSA (veya değerlendirilemiyorsa):</strong></p>
                <ul>
                    <li>İnsülin İnfüzyonunu **STOP'la**.</li>
                    <li>12,5 gram (%50 Dekstrozdan 25 ml (7 dakikada bolus) veya %30 Dekstrozdan 42 ml (5 dakikada bolus)) IV dekstroz bolus ver.</li>
                    <li>Kan Şekeri 15 dakikada bir kontrol et.</li>
                </ul>
                <p><strong>Hastada hipoglisemi semptomları YOKSA:</strong></p>
                <ul>
                    <li>12,5 gram (%50 Dekstrozdan 25 ml (7 dakikada bolus) veya %30 Dekstrozdan 42 ml (5 dakikada bolus)) IV dekstroz bolus ver veya 250 ml meyve suyu içir.</li>
                    <li>Kan Şekeri 100 mg/dl ve üzerine ulaşırsa; 1 saat bekle, sonra insülin infüzyonuna orijinal hızdan %25 düşüğüyle başla.</li>
                </ul>
            </div>

            <button class="accordion">3. Kan Şekeri 75 mg/dl ve Üzerindeyse <span class="accordion-arrow">&#9660;</span></button>
            <div class="panel">
                <p>Önce **Hastanın Kan Şekeri sütununu BUL**. Sonra, önceki Kan Şekerin'den ne kadar farklı olduğunu belirle ve sütunun altında bulunan uygun kutucuğa git. Kutucuğu bulduktan sonra, sağda o kutucuğa ait değişim açıklamasına git. (Değişim miktarında saatteki değişimin alındığına dikkat edin. Örnek: Saat 14:00'de KŞ 160 mg/dl ve sonraki ölçüm 16:00'da 200 mg/dl ise, toplam değişim 40 mg ve saatlik değişim **20 mg/dl**'dir).</p>
            </div>
        </div>

        <div class="section">
            <h2>Kan Şekeri Değişim Tablosu</h2>
            <table>
                <thead>
                    <tr>
                        <th>75-99 mg/dl</th>
                        <th>KŞ 100-139 mg/dl</th>
                        <th>KŞ 140-199 mg/dl</th>
                        <th>KŞ 200 mg/dl ve üzeri</th>
                        <th>Açıklama*</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td></td>
                        <td></td>
                        <td>KŞ 51 mg/dl/Saat<br>veya daha fazla artmış</td>
                        <td>KŞ artmış</td>
                        <td class="explanation-cell">"2Δ" kadar arttır</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>KŞ 26 mg/dl/Saat veya daha fazla artmış</td>
                        <td>KŞ 1-50 mg/dl/Saat<br>artmış veya KŞ değişmemiş</td>
                        <td>KŞ değişmemiş veya 1-25 mg/dl/Saat azalmış</td>
                        <td class="explanation-cell">"Δ" kadar arttır</td>
                    </tr>
                    <tr>
                        <td>KŞ artmış</td>
                        <td>KŞ 1-25 mg/dl/Saat artmış veya KŞ değişmemiş veya 1-25 mg/dl/Saat azalmış</td>
                        <td>KŞ 1-50 mg/dl/Saat azalmış</td>
                        <td>KŞ 26-75 mg/dl/Saat<br>azalmış</td>
                        <td class="explanation-cell">Değişiklik YAPMA</td>
                    </tr>
                    <tr>
                        <td>KŞ değişmemiş veya 1-25 mg/dl/Saat azalmış</td>
                        <td>KŞ 26-50 mg/dl/Saat azalmış</td>
                        <td>KŞ 51-75 mg/dl/Saat azalmış</td>
                        <td>KŞ 76-100 mg/dl/Saat azalmış</td>
                        <td class="explanation-cell">"Δ" kadar azalt</td>
                    </tr>
                    <tr>
                        <td>KŞ 26 mg/dl/Saat<br>veya daha fazla azalmış **</td>
                        <td>KŞ 51 mg/dl/Saat veya daha fazla azalmış</td>
                        <td>KŞ 76 mg/dl/Saat azalmış</td>
                        <td>KŞ 101 mg/dl/Saat veya daha fazla azalmış</td>
                        <td class="explanation-cell">30 dakika DURDUR, sonra<br>"2Δ" kadar azalt</td>
                    </tr>
                    <tr>
                        <td class="special-note-cell">"İnsülini STOP'la, 30 dak.da bir KŞ<br>bak. Eğer KŞ 100 mg/dl ve<br>üzerine ulaşırsa önceki hızı %25<br>azalt ve başla."</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <div class="warning-box" style="font-size: 0.9em; text-align: center;">
                *İnfüzyon hızındaki değişim (Δ), mevcut hıza göre belirlenir.
            </div>
            <div class="infusion-rate-table">
                <table>
                    <thead>
                        <tr>
                            <th>Mevcut İnfüzyon Hızı (Ünite/Saat)</th>
                            <th>Δ</th>
                            <th>2Δ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>≤ 2.5</td><td>0.5</td><td>1</td></tr>
                        <tr><td>3.0-6.0</td><td>1</td><td>2</td></tr>
                        <tr><td>6.5-9.5</td><td>1.5</td><td>3</td></tr>
                        <tr><td>10-14.5</td><td>2</td><td>4</td></tr>
                        <tr><td>15-19.5</td><td>3</td><td>6</td></tr>
                        <tr><td>20-24.5</td><td>4</td><td>8</td></tr>
                        <tr><td>≥ 25</td><td>≥5</td><td>10 (Doktora Haber Veriniz)</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <button class="accordion warning-accordion">UYARI <span class="accordion-arrow">&#9660;</span></button>
        <div class="panel">
            <div class="section">
                <p>Bu protokol erişkinler için düzenlenmiştir, 16 yaş altı pediatrik hastaları kapsamaz. Aşağıdaki insülin infüzyon protokolü hekim gerekli görürse başlatılır.</p>
                <p>Kan şekeri (KŞ), glukometre ile ölçülen değeri ifade eder. Eğer bu değer 500 mg/dl ve üzerindeyse hekim bireysel olarak tedavi düzenlemesinde bulunabilir.</p>
                <p>Bu protokolün uygulanması sırasında olağan dışı bir durum, bu protokolün kapsamadığı bir sorun ortaya çıkarsa veya:</p>
                <div class="warning-box">
                    <strong>&lt; 74 mg/dl veya > 300 mg/dl</strong> kan şekerlerinde hekimi bilgilendiriniz.
                </div>
                <p>İnsülin İnfüzyon Protokolü Uygulamasında yanlışlık olduğunu düşündüğünüz durumlarda Hayati risk nedeniyle, herhangi bir tereddütte orijinal protokole başvurulması önemlidir.</p>
            </div>
        </div>

        <button class="accordion">İnsülin İnfüzyonuna Başlama ve Ölçme Protokolü <span class="accordion-arrow">&#9660;</span></button>
        <div class="panel">
            <div class="section">
                <h2>İnsülin İnfüzyonuna Başlama</h2>
                <ul>
                    <li>250 ml izotonik sodyum klorür (%0,9 sodyum klorür) içine 250 ünite humulin-R konularak standart izotonik-insülin solüsyonu hazırlanır.</li>
                    <li>Solüsyon setlendikten sonra 50 ml karışım boşa akıtılır. Bunun amacı sette insülin bağlanma yerlerini doyurmaktır.</li>
                    <li>Bu solüsyonun 1 ml'sinde 1 ünite humulin R bulunur.</li>
                    <li>İnfüzyon uygulanmaya başlandıktan sonra 24 saatte bir seti ile beraber değiştirilmesi gerekir. İnfüzyon pompası aracılığıyla gönderilmesi gerekir.</li>
                    <li>İnsülin infüzyon setinin üzerine yüksek riskli ilaç etiketi yapıştırılarak, sekonder ucundan başka infüzyon gönderilmemesi gerekir.</li>
                    <li>Yüksek riskli ilaç tedavilerinin hazırlanması, uygulanması ve kayıt şahit eşliğinde "Yüksek Riskli İlaçların Yönetimi Ve Güvenli İlaç Kullanımı Talimatı"na göre yapılır.</li>
                </ul>
                <div class="info-point">
                    <strong>► Hedef Kan Şekeri değeri 100-139 mg/dl'dir.</strong>
                </div>
                <h3>İnfüzyonu Başlatmak:</h3>
                <ul>
                    <li>149 mg/dl ve altındaki Kan Şekeri değerlerinde infüzyona başlanıp başlanmamasını hekime danışınız. Bolus insülin, hekim belirtmedikçe uygulamayın.</li>
                    <li><strong>150-199 mg/dl</strong> ve arasındaki değerlerde bolus yapmadan 1 ünite/saat başlayın.</li>
                    <li><strong>200-299 mg/dl</strong> ise 2 ünite/saat başlayın.</li>
                    <li><strong>300-399 mg/dl</strong> ise 3 ünite/saat başlayın. Bu kan şekerine bolus insülin konusunda hekimin önerisi olabilir.</li>
                    <li><strong>400-499 mg/dl</strong> ise 4 ünite/saat başlayın. Bu kan şekerine bolus insülin konusunda hekimin önerisi olabilir.</li>
                </ul>
            </div>

            <div class="section">
                <h2>Ölçme Protokolü</h2>
                <ul>
                    <li>1- Hasta stabil olana kadar saatte bir Kan Şekeri bakın (Stabil = 3 ardışık Kan Şekeri, hedef (100-139 mg/dl) değerlerdedir).</li>
                    <li>2- Stabilleşince de 2 saatte bir Kan Şekeri ölçümü yapın.</li>
                    <li>2 saatte bir ölçüm yapıldığında önceki ile farkın 2'ye bölünmesi gerektiğini bilmemiz gerekir.
                        <br><strong>Örneğin:</strong> Son Kan Şekeri 120 mg/dl. 2 saat sonra ölçülen 180 mg/dl ise toplam değişim 200-160 = 40 mg ve saatlik değişim 20 mg'dır yani Kan Şekeri 20 mg/dl/saat artmış olmaktadır).
                        <br><strong>İnsülin infüzyon hızı daima saatlik KŞ değişimine göre ayarlanmaktadır.</strong>
                    </li>
                </ul>
                <h3>3- Eğer aşağıdakilerden biri olursa yeniden saatlik Kan Şekeri ölçümüne dönün:</h3>
                <ol type="a">
                    <li>İnsülin hızında herhangi bir değişim (Örneğin Kan Şeker hedef değerin dışındaysa)</li>
                    <li>Klinik durumda anlamlı değişiklik</li>
                    <li>Vazopressor tedaviyi kesme veya başlama (Vazopressor tedavi = dopamin, adrenalin, noradrenalin, efedrin vs.)</li>
                    <li>Renal replasman tedavisinin kesilmesi veya başlanması (Renal replasman tedavisi hemodiyaliz, devamlı veno-venöz hemofiltrasyon, periton diyalizi vs.)</li>
                    <li>Nutrisyonel desteğin başlanması, kesilmesi veya değiştirilmesi (Oral gıda, TPN, PPN, oliclinomel, desktrozlu solüsyonlar, NG veya PEG ile besleme vb.)</li>
                </ol>
            </div>
        </div>

        <button class="accordion bibliography-accordion">Kaynakça <span class="accordion-arrow">&#9660;</span></button>
        <div class="panel">
            <div class="bibliography">
                <h2>Kaynakça</h2>
                <ol>
                    <li>Vanderbilt University Medical Center. (2016, Ocak). SICU Glycemic Protocol. Trauma and Surgical Critical Care Service. Erişim adresi: <a href="https://www.vumc.org/trauma-and-scc/sites/vumc.org.trauma-and-scc/files/public_files/Protocols/Glycemic%20Protocol-%20Approved%20January%202016.pdf" target="_blank">https://www.vumc.org/trauma-and-scc/sites/vumc.org.trauma-and-scc/files/public_files/Protocols/Glycemic%20Protocol-%20Approved%20January%202016.pdf</a></li>
                    <li>Passarelli, M., Silva, M. A., & Araújo, T. M. E. (2016). Nurse-managed insulin infusion protocol in critically ill patients: An evaluation of efficacy and safety. Journal of Clinical Nursing, 25(1–2), 146–154. <a href="https://doi.org/10.1111/jocn.13034" target="_blank">https://doi.org/10.1111/jocn.13034</a></li>
                    <li>Gibson, J., Wulff, K., & Hollis, R. (2016). Implementation of an updated insulin infusion protocol for the management of hyperglycemia in hospitalized patients. American Journal of Health-System Pharmacy, 73(11 Suppl 3), S88–S96. <a href="https://doi.org/10.2146/ajhp150565" target="_blank">https://doi.org/10.2146/ajhp150565</a></li>
                    <li>Umpierrez, G. E., Hellman, R., Korytkowski, M. T., Kosiborod, M., Maynard, G. A., Montori, V. M., Seley, J. J., & Van den Berghe, G.; Endocrine Society. (2012). Management of hyperglycemia in hospitalized patients in non-critical care settings: An Endocrine Society clinical practice guideline. The Journal of Clinical Endocrinology & Metabolism, 97(1), 16–38. <a href="https://doi.org/10.1210/jc.2011-2098" target="_blank">https://doi.org/10.1210/jc.2011-2098</a></li>
                </ol>
            </div>
        </div>
        
        <footer class="footer-text">
            <p>Uzm. Hem. Gürkan ÇAMOK</p>
            <p>Diyabet Vaka Yöneticisi</p>
        </footer>
    </div>

    <script>
        // Accordion script
        var acc = document.getElementsByClassName("accordion");
        var i;

        for (i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var panel = this.nextElementSibling;
                if (panel.style.maxHeight) {
                    panel.style.maxHeight = null;
                } else {
                    panel.style.maxHeight = panel.scrollHeight + "px";
                }
            });
        }
        
        // Hesaplayıcı scripti
        function calculateInfusion() {
            const currentBs = parseFloat(document.getElementById('currentBs').value);
            const previousBsInput = document.getElementById('previousBs').value;
            const previousBs = previousBsInput ? parseFloat(previousBsInput) : null;
            const previousBsTime = parseFloat(document.getElementById('previousBsTime').value);
            const currentInfusionRate = parseFloat(document.getElementById('currentInfusionRate').value);
            const resultBox = document.getElementById('result');
            const errorBox = document.getElementById('error');

            resultBox.innerHTML = '';
            errorBox.style.display = 'none';

            if (isNaN(currentBs) || isNaN(currentInfusionRate) || (previousBsInput !== '' && isNaN(previousBsTime))) {
                errorBox.style.display = 'block';
                resultBox.innerHTML = 'Hata: Lütfen tüm gerekli alanları doldurun ve geçerli değerler girin.';
                return;
            }

            if (currentBs < 74 || currentBs > 300) {
                resultBox.innerHTML += `<div class="warning-box"><strong>UYARI:</strong> Kan Şekeri ${currentBs} mg/dl. Hekimi bilgilendiriniz.</div>`;
            }

            if (currentBs >= 100 && currentBs <= 139) {
                resultBox.innerHTML += `<p><strong>Mevcut Kan Şekeri: ${currentBs} mg/dl - Hedef aralıkta.</strong></p>`;
            } else {
                resultBox.innerHTML += `<p><strong>Mevcut Kan Şekeri: ${currentBs} mg/dl - Hedef aralık dışında (Hedef: 100-139 mg/dl).</strong></p>`;
            }

            if (currentBs <= 50) {
                resultBox.innerHTML += `<div class="result-box">
                    <p><strong>Kan Şekeri ${currentBs} mg/dl:</strong></p>
                    <ul>
                        <li>İnsülin infüzyonunu <strong>STOP'la</strong>.</li>
                        <li>25 gram (%50 Dekstrozdan 50 ml (15 dakikada bolus) veya %30 Dekstrozdan 85 ml (9 dakikada bolus)) IV dekstroz bolus ver. Kan Şekeri 15 dakikada bir kontrol et.</li>
                        <li>Kan Şekeri 100 mg/dl ve üzerine ulaşırsa, <strong>1 saat sonra</strong> insülin infüzyonuna <strong>orijinal hızdan %50 düşüğüyle</strong> (${(currentInfusionRate * 0.5).toFixed(1)} Ünite/saat) başla.</li>
                    </ul>
                </div>`;
                return;
            }

            if (currentBs >= 51 && currentBs <= 74) {
                resultBox.innerHTML += `<div class="result-box">
                    <p><strong>Kan Şekeri ${currentBs} mg/dl:</strong></p>
                    <p>Hastada hipoglisemi semptomları VARSA (veya değerlendirilemiyorsa):</p>
                    <ul>
                        <li>İnsülin İnfüzyonunu **STOP'la**.</li>
                        <li>12.5 gram (%50 Dekstrozdan 25 ml (7 dakikada bolus) veya %30 Dekstrozdan 42 ml (5 dakikada bolus)) IV dekstroz bolus ver.</li>
                        <li>Kan Şekeri 100 mg/dl ve üzerine ulaşırsa; 1 saat bekle, sonra insülin infüzyonuna orijinal hızdan %25 düşüğüyle başla.</li>
                    </ul>
                </div>`;
                return;
            }

            let hourlyChange = null;
            if (previousBs !== null && previousBsTime > 0) {
                hourlyChange = (currentBs - previousBs) / previousBsTime;
                resultBox.innerHTML += `<p>Önceki KŞ: ${previousBs} mg/dl (${previousBsTime} saat önce). Saatlik KŞ değişimi: <strong>${hourlyChange.toFixed(2)} mg/dl/saat</strong>.<br><small>Pozitif değer artışı, negatif değer azalışı gösterir.</small></p>`;
            } else {
                resultBox.innerHTML += `<p><small>Önceki Kan Şekeri veya ölçüm süresi girilmediği için saatlik değişim hesaplanamadı. Tablo eşleşmesi yalnızca mevcut KŞ değerine göre yapılacak ve saatlik değişim gerektiren hücreler eşleşmeyecektir.</small></p>`;
            }

            let delta = 0;
            let twoDelta = 0;

            if (currentInfusionRate <= 2.5) {
                delta = 0.5;
                twoDelta = 1;
            } else if (currentInfusionRate >= 3.0 && currentInfusionRate <= 6.0) {
                delta = 1;
                twoDelta = 2;
            } else if (currentInfusionRate >= 6.5 && currentInfusionRate <= 9.5) {
                delta = 1.5;
                twoDelta = 3;
            } else if (currentInfusionRate >= 10.0 && currentInfusionRate <= 14.5) {
                delta = 2;
                twoDelta = 4;
            } else if (currentInfusionRate >= 15.0 && currentInfusionRate <= 19.5) {
                delta = 3;
                twoDelta = 6;
            } else if (currentInfusionRate >= 20.0 && currentInfusionRate <= 24.5) {
                delta = 4;
                twoDelta = 8;
            } else if (currentInfusionRate >= 25) {
                delta = 5;
                twoDelta = 10;
                resultBox.innerHTML += `<div class="warning-box"><strong>UYARI:</strong> Mevcut infüzyon hızı ≥ 25 Ünite/Saat. Doktora Haber Veriniz.</div>`;
            }

            let newInfusionRate = currentInfusionRate;
            let finalActionText = "Belirlenmedi (Tablo eşleşmesi bulunamadı veya eksik veri).";

            if (currentBs >= 75 && currentBs <= 99) {
                if (hourlyChange !== null) {
                    if (hourlyChange <= -26) {
                        newInfusionRate = Math.max(0, currentInfusionRate - twoDelta);
                        finalActionText = `<strong>İnsülini STOP'la</strong>, 30 dak.da bir KŞ bak. Eğer KŞ 100 mg/dl ve üzerine ulaşırsa önceki hızı %25 azalt (${(currentInfusionRate * 0.75).toFixed(1)} Ünite/saat) ve başla. <br> Tablo Aksiyonu: 30 dakika DURDUR, sonra "2Δ" kadar azalt (${twoDelta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange >= -25 && hourlyChange <= 0) {
                        newInfusionRate = Math.max(0, currentInfusionRate - delta);
                        finalActionText = `"Δ" kadar azalt (${delta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange > 0) {
                        finalActionText = "Değişiklik YAPMA. Mevcut hız: " + currentInfusionRate.toFixed(1) + " Ünite/saat.";
                    }
                } else {
                    finalActionText = "Saatlik değişim verisi olmadığı için kesin tablo eşleşmesi yapılamadı. KŞ " + currentBs.toFixed(1) + " mg/dl aralığında. Hız değişmedi.";
                }

            } else if (currentBs >= 100 && currentBs <= 139) {
                if (hourlyChange !== null) {
                    if (hourlyChange <= -51) {
                        newInfusionRate = Math.max(0, currentInfusionRate - twoDelta);
                        finalActionText = `30 dakika DURDUR, sonra "2Δ" kadar azalt (${twoDelta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange >= -50 && hourlyChange <= -26) {
                        newInfusionRate = Math.max(0, currentInfusionRate - delta);
                        finalActionText = `"Δ" kadar azalt (${delta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange >= -25 && hourlyChange <= 25) {
                        finalActionText = "Değişiklik YAPMA. Mevcut hız: " + currentInfusionRate.toFixed(1) + " Ünite/saat.";
                    } else if (hourlyChange >= 26) {
                        newInfusionRate = currentInfusionRate + delta;
                        finalActionText = `"Δ" kadar arttır (${delta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    }
                } else {
                    finalActionText = "Saatlik değişim verisi olmadığı için kesin tablo eşleşmesi yapılamadı. KŞ " + currentBs.toFixed(1) + " mg/dl aralığında. Hız değişmedi.";
                }
            } else if (currentBs >= 140 && currentBs <= 199) {
                if (hourlyChange !== null) {
                    if (hourlyChange <= -76) {
                        newInfusionRate = Math.max(0, currentInfusionRate - twoDelta);
                        finalActionText = `30 dakika DURDUR, sonra "2Δ" kadar azalt (${twoDelta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange >= -75 && hourlyChange <= -51) {
                        newInfusionRate = Math.max(0, currentInfusionRate - delta);
                        finalActionText = `"Δ" kadar azalt (${delta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange >= -50 && hourlyChange <= -1) {
                        finalActionText = "Değişiklik YAPMA. Mevcut hız: " + currentInfusionRate.toFixed(1) + " Ünite/saat.";
                    } else if (hourlyChange >= 0 && hourlyChange <= 50) {
                        newInfusionRate = currentInfusionRate + delta;
                        finalActionText = `"Δ" kadar arttır (${delta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange > 50) {
                        newInfusionRate = currentInfusionRate + twoDelta;
                        finalActionText = `"2Δ" kadar arttır (${twoDelta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    }
                } else {
                    finalActionText = "Saatlik değişim verisi olmadığı için kesin tablo eşleşmesi yapılamadı. KŞ " + currentBs.toFixed(1) + " mg/dl aralığında. Hız değişmedi.";
                }
            } else if (currentBs >= 200) {
                if (hourlyChange !== null) {
                    if (hourlyChange <= -101) {
                        newInfusionRate = Math.max(0, currentInfusionRate - twoDelta);
                        finalActionText = `30 dakika DURDUR, sonra "2Δ" kadar azalt (${twoDelta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange >= -100 && hourlyChange <= -76) {
                        newInfusionRate = Math.max(0, currentInfusionRate - delta);
                        finalActionText = `"Δ" kadar azalt (${delta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange >= -75 && hourlyChange <= -26) {
                        finalActionText = "Değişiklik YAPMA. Mevcut hız: " + currentInfusionRate.toFixed(1) + " Ünite/saat.";
                    } else if (hourlyChange >= -25 && hourlyChange <= 0) {
                        newInfusionRate = currentInfusionRate + delta;
                        finalActionText = `"Δ" kadar arttır (${delta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    } else if (hourlyChange > 0) {
                        newInfusionRate = currentInfusionRate + twoDelta;
                        finalActionText = `"2Δ" kadar arttır (${twoDelta} Ünite/saat). Yeni hız: ${newInfusionRate.toFixed(1)} Ünite/saat.`;
                    }
                } else {
                    finalActionText = "Saatlik değişim verisi olmadığı için kesin tablo eşleşmesi yapılamadı. KŞ " + currentBs.toFixed(1) + " mg/dl aralığında. Hız değişmedi.";
                }
            }

            resultBox.innerHTML += `<div class="result-box">
                <p><strong>Önerilen Eylem:</strong> ${finalActionText}</p>
            </div>`;
        }
    </script>
</body>
</html>
